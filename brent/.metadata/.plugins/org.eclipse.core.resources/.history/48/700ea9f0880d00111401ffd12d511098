import java.nio.ByteBuffer;

import org.apache.cassandra.thrift.*;
import org.apache.thrift.protocol.TProtocol;
import org.apache.thrift.transport.TFramedTransport;
import org.apache.thrift.transport.TTransport;
import org.apache.thrift.transport.TSocket;

public class foff1 {
	public static void main(String[] args) throws Exception {
		TTransport transport = new TFramedTransport(new TSocket("10.9.73.119", 9160));
		TProtocol protocol = new TBinaryProtocol(transport);
		Cassandra.Client client = new Cassandra.Client(protocol);
		transport.open();
		
		client.set_keyspace("tutorials");

		// Define a column parent
		ColumnParent parent = new ColumnParent("User");
		
		// Define a row id
		ByteBuffer rowid = ByteBuffer.wrap("100".getBytes());

		// Define a column to add
		Column description = new Column();
		description.setName("description".getBytes());
		description.setValue("I'm a nice guy".getBytes());
		description.setTimestamp(System.currentTimeMillis());

		// Set the consistency level
		ConsistencyLevel consistencyLevel = ConsistencyLevel.ONE;

		// Insert the value
		client.insert(rowid, parent, description, consistencyLevel);
		
		// Read a column value
		ColumnPath path = new ColumnPath();
		path.column_family = "User";
		path.column = ByteBuffer.wrap("username".getBytes());
		ColumnOrSuperColumn result = client.get(rowid, path, consistencyLevel);
		Column column = result.column;
		System.out.println(column.name.toString() + ":" column.value.toString());
		
		transport.flush();
		transport.close();
	}
}